name: Keep Multiple Sites Awake

on:
  schedule:
    - cron: "*/5 * * * *"
  workflow_dispatch:

jobs:
  ping-sites:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        site: [
          "https://flixtvon-aiolist.hf.space",
          "https://flixtvon-aiostremio.hf.space/stremio/configure", 
          "https://streamflixapi.brunoflix9.workers.dev",
          "https://flixtvon-chatgpt-v1.hf.space"
        ]
    steps:
      - name: Ping ${{ matrix.site }}
        run: |
          echo "üîç Pingando: ${{ matrix.site }}"
          
          # Tenta 3 vezes
          for i in {1..3}; do
            echo "Tentativa $i de 3..."
            http_code=$(curl -s -o /dev/null -w "%{http_code}" --max-time 30 "${{ matrix.site }}")
            
            if [ "$http_code" -eq 200 ] || [ "$http_code" -eq 302 ] || [ "$http_code" -eq 307 ] || [ "$http_code" -eq 403 ]; then
              echo "‚úÖ Online! C√≥digo HTTP: $http_code"
              exit 0
            else
              echo "‚ùå Falhou com c√≥digo: $http_code"
              if [ $i -lt 3 ]; then
                sleep 5
              fi
            fi
          done
          
          echo "‚ö†Ô∏è Falha ap√≥s 3 tentativas"
          exit 1
